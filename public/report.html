<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>意见参考书</title>
    <script src="https://cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="js/flexble-main.js"></script>
    <script src="js/modernizr-2.8.2.js"></script>
    <style>
        blockquote,body,button,dd,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,img,input,label,legend,li,ol,p,pre,select,table,tbody,td,textarea,tfoot,th,thead,tr,ul{margin:0;padding:0}body,button,input,select,textarea{font:14px/16px PingFang,"Source Han Sans CN","\5B8B\4F53","Arial Narrow";-webkit-text-size-adjust:100%}address,cite,code,em,th,var{font-weight:400;font-style:normal}input[type=text]:focus,input[type=password]:focus{outline:0}button,input,select,textarea{font-size:100%}h1,h2,h3,h4,h5,h6{font-size:100%}img,input,select{vertical-align:middle}button,input{-webkit-appearance:none}button,input,textarea{outline:0}fieldset,img{border:0}ol,ul{list-style:none}li{list-style-type:none}table{border-collapse:collapse;border-spacing:0}p{word-wrap:break-word}a{text-decoration:none}a:active,a:focus,a:hover,a:link,a:visited{text-decoration:none}a{-webkit-tap-highlight-color:transparent;-webkit-background:transparent}textarea{box-shadow:0 0 0 transparent;-webkit-background:transparent;-webkit-appearance:none}body,html{margin:0 auto}html{overflow-x:hidden}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}.clearfix{zoom:1}.clearfix:after{clear:both;content:"";display:block;height:0;line-height:0;visibility:hidden}.hide{display:none}body{background:#fff}#opinionBook{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;padding:0 .37333rem;height:auto;overflow:hidden;padding-bottom:1.8rem}h1{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;height:1.54667rem;line-height:1.54667rem;font-family:PingFangSC-Medium;font-weight:700;font-size:.48rem;color:#303030;text-align:center}h3{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;height:1.44rem;line-height:1.44rem;font-family:PingFangSC-Regular;font-weight:500;font-size:.42667rem;color:#303030}h3>i{float:right;text-align:right;cursor:pointer;font-style:normal;font-family:PingFangSC-Light;font-weight:lighter;font-size:.32rem;color:#303030}h3>i>img{width:.45333rem;height:.45333rem;margin:-.05333rem 0 0 .12rem}hr{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;height:1px;color:#e6e6e6;border:none;border-top:1px solid #e6e6e6;text-align:center}.section{position:relative}.section>i{width:100%;height:1.25333rem;line-height:1.25333rem;text-align:right;display:block;cursor:pointer;font-style:normal;font-family:PingFangSC-Light;font-weight:lighter;font-size:.32rem;color:#303030}.section>i>img{width:.45333rem;height:.45333rem;margin:-.05333rem 0 0 .12rem}.content{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:.4rem;width:100%;height:auto;border-radius:.26667rem;overflow:hidden;background:url(img/bg.png) no-repeat left bottom rgba(242,97,149,.7);background-origin:content-box;background-size:3.06667rem 3.49333rem}.list-show{display:none}.content>p{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-family:PingFangSC-Light;font-weight:lighter;font-size:.42667rem;color:#fff;letter-spacing:-.00533rem;text-align:justify;line-height:.64rem;margin-top:.64rem}.content>p:first-child{margin-top:0}.content>p:last-child{padding-bottom:1.33333rem}.special{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%}.special>p{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-family:PingFangSC-Light;font-weight:lighter;font-size:.42667rem;line-height:.77333rem;color:#000;margin-top:.64rem;text-align:justify}.special>p:first-child{margin-top:0}.special>p>i{color:#f26195;font-style:normal}.footer{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;padding-top:.49333rem;height:auto;position:fixed;bottom:0}.function-btn{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-align-items:center;-moz-align-items:center;align-items:center;-webkit-justify-content:space-between;-moz-justify-content:space-between;justify-content:space-between;width:100%;height:1.30667rem;line-height:1.30667rem;background:#f26195}.btn-content{display:inline-block;width:100%;height:.56rem;line-height:.56rem}.btn-content>a{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;float:left;width:50%;line-height:.53333rem;font-family:PingFangSC-Regular;font-weight:lighter;font-size:.48rem;color:#fff;text-align:center;cursor:pointer}.btn-content>a:last-child{border:none;border-left:1px solid}.load-container{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-align-items:center;-moz-align-items:center;align-items:center;-webkit-justify-content:center;-moz-justify-content:center;justify-content:center;width:2rem;height:2rem;float:left;position:fixed;top:50%;left:50%;margin:-1rem 0 0 -1rem;overflow:hidden;-moz-box-sizing:border-box;box-sizing:border-box;background:rgba(0,0,0,.6);border-radius:.24rem;z-index:999}.remind{position:fixed;left:0;top:0;height:100%;width:100%;-webkit-transition:opacity .3s 0s,visibility 0s .3s;-moz-transition:opacity .3s 0s,visibility 0s .3s;transition:opacity .3s 0s,visibility 0s .3s;z-index:999;display: none;}.remind .re-box{position:absolute;width:100%;top:45%;text-align:center;}.remind .re-box p{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;display:block;padding:.26667rem;float:left;font-family:PingFangSC-Regular;font-size:.42667rem;font-weight:200;letter-spacing:.002rem;text-align:center;color:#303030}.remind .re-box .btn{width:100%;height:auto;text-align:center;float:left}.remind .re-box .btn .download{width:1.97333rem;height:.8rem;line-height:.8rem;text-align:center;display:block;cursor:pointer;color:#fff;font-family:PingFangSC-Regular;font-size:.4rem;font-weight:200;letter-spacing:.00187rem;background:#46a0fc;border-radius:.2rem;margin:.29333rem auto 0}.load4 .loader{-webkit-backface-visibility:hidden;font-size:.2rem;margin:5em auto;width:1em;height:1em;-webkit-border-radius:999em;-moz-border-radius:999em;-ms-border-radius:999em;-o-border-radius:999em;border-radius:999em;position:relative;text-indent:-9999em;-webkit-animation:load4 1.3s infinite linear;animation:load4 1.3s infinite linear}@-webkit-keyframes load4{0%,100%{box-shadow:0 -3em 0 .2em #fff,2em -2em 0 0 #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 0 #fff}12.5%{box-shadow:0 -3em 0 0 #fff,2em -2em 0 .2em #fff,3em 0 0 0 #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}25%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 0 #fff,3em 0 0 .2em #fff,2em 2em 0 0 #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}37.5%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 0 #fff,2em 2em 0 .2em #fff,0 3em 0 0 #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}50%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 0 #fff,0 3em 0 .2em #fff,-2em 2em 0 0 #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}62.5%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 0 #fff,-2em 2em 0 .2em #fff,-3em 0 0 0 #fff,-2em -2em 0 -.5em #fff}75%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 0 #fff,-3em 0 0 .2em #fff,-2em -2em 0 0 #fff}87.5%{box-shadow:0 -3em 0 0 #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 0 #fff,-3em 0 0 0 #fff,-2em -2em 0 .2em #fff}}@keyframes load4{0%,100%{box-shadow:0 -3em 0 .2em #fff,2em -2em 0 0 #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 0 #fff}12.5%{box-shadow:0 -3em 0 0 #fff,2em -2em 0 .2em #fff,3em 0 0 0 #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}25%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 0 #fff,3em 0 0 .2em #fff,2em 2em 0 0 #fff,0 3em 0 -.5em #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}37.5%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 0 #fff,2em 2em 0 .2em #fff,0 3em 0 0 #fff,-2em 2em 0 -.5em #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}50%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 0 #fff,0 3em 0 .2em #fff,-2em 2em 0 0 #fff,-3em 0 0 -.5em #fff,-2em -2em 0 -.5em #fff}62.5%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 0 #fff,-2em 2em 0 .2em #fff,-3em 0 0 0 #fff,-2em -2em 0 -.5em #fff}75%{box-shadow:0 -3em 0 -.5em #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 0 #fff,-3em 0 0 .2em #fff,-2em -2em 0 0 #fff}87.5%{box-shadow:0 -3em 0 0 #fff,2em -2em 0 -.5em #fff,3em 0 0 -.5em #fff,2em 2em 0 -.5em #fff,0 3em 0 -.5em #fff,-2em 2em 0 0 #fff,-3em 0 0 0 #fff,-2em -2em 0 .2em #fff}}
    </style>
</head>
<body>

    <!-- loading begin -->
    <div class="load-container load4">
      <div class="loader">Loading...</div>
    </div>
    <!-- error begin -->
    <div class="remind">
        <div class="re-box"></div>
    </div>
    <!-- error end -->
    <!-- loading end -->
    <main id="opinionBook"></main>
    <script type="text/javascript">
        var API="http://fdev.vrcdkj.cn/api"
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            var r = window.location.search.substr(1).match(reg);  //匹配目标参数
            if (r != null) return unescape(r[2]); return null; //返回参数值
        }
        $(function () {
            var opinion_id=getUrlParam('id') || 15;
            var device_id=getUrlParam('device')
            if(!(opinion_id && device_id)){
                $(".load-container").remove()
                $(".remind .re-box").html('<p>缺少参数</p>');
                $(".remind").fadeIn()
                return false
            }
            // 测试loading
            // setTimeout(function(){
            $.ajax({  
                url: API+'/v1/record/opinion/'+opinion_id,  
                type: 'GET',  
                dataType: 'json',  
                timeout: 5000,
                cache: false,  
                beforeSend: function(request){
                     request.setRequestHeader("Device", device_id);
                },
                error: function(){
                    $(".load-container").remove()
                    $(".remind .re-box").html('<p>加载失败...</p><div class="btn"><a class="download" href="location.reload">刷新</a></div>');
                    $(".remind").fadeIn()
                },  //错误执行方法    
                success: function(response){
                    if(response.error_no!=0){
                        $(".load-container").remove()
                        $(".remind .re-box").html('<p>加载失败...</p><div class="btn"><a class="download" href="location.reload">刷新</a></div>');
                        $(".remind").fadeIn()
                        return false
                    }
                    $(".load-container").remove()
                    var data=response.data;
                    var html=""
                    html+='<header id="header">';
                    html+='<h1>（2018）第'+opinion_id+'号</h1>';
                    html+='</header>';
                    html+='<hr>';
                    // 法规栏
                    if(data.law_rule){
                        html+='<section id="section" class="section">';
                        html+='<h3>';
                        html+=data.law_rule.name+'<i class="list-show">展开<img src="img/show.png"></i>';
                        html+='</h3>';
                        html+='<article class="content">';
                        for(index in data.law_rule.content){
                            html+='<p>'+(parseInt(index)+1)+'、《'+data.law_rule.content[index].fullname+'》'+data.law_rule.content[index].title+"</p>";
                            html+='<p>'+data.law_rule.content[index].content+'</p>';
                        }
                        html+='</article>';
                        html+='<i class="list-hide">收起<img src="img/hide.png"></i>';
                        html+='</section>';
                        html+='<hr>';
                    }
                    // 经调查了解
                    if(data.understand){
                        html+='<section id="section" class="section">';
                        html+='<h3>';
                        html+=data.understand.name+'<i class="list-show">展开<img src="img/show.png"></i>';
                        html+='</h3>';
                        html+='<article class="special">';
                        html+='<p>'+data.understand.content+'</p>'
                        html+='</article>';
                        html+='<i class="list-hide">收起<img src="img/hide.png"></i>';
                        html+='</section>';
                        html+='<hr>';
                    }
                    // 本次建议如下
                    if(data.suggest){
                        html+='<section id="section" class="section">';
                        html+='<h3>';
                        html+=data.suggest.name+'<i class="list-show">展开<img src="img/show.png"></i>';
                        html+='</h3>';
                        html+='<article class="content">';
                        for(index in data.suggest.content){
                            html+='<p>'+data.suggest.content[index]+'</p>';
                        }
                        html+='</article>';
                        html+='<i class="list-hide">收起<img src="img/hide.png"></i>';
                        html+='</section>';
                        html+='<hr>';
                    }
                    // 四、综上所述
                    if(data.judgment){
                        html+='<section id="section" class="section">';
                        html+='<h3>';
                        html+=data.judgment.name+'<i class="list-show">展开<img src="img/show.png"></i>';
                        html+='</h3>';
                        html+='<article class="content">';
                        for(index in data.judgment.content){
                            html+='<p>'+data.judgment.content[index]+'</p>';
                        }
                        html+='</article>';
                        html+='<i class="list-hide">收起<img src="img/hide.png"></i>';
                        html+='</section>';
                        html+='<hr>';
                    }
                    $("#opinionBook").html(html)
                }   
            })
             // },4000)
        });
        $(function(){
            $(document).on('click','.list-show',function(){
                var other=$(".section").not(parent)
                other.find('article').slideUp()
                other.find('.list-show').fadeIn();
                other.find('.list-hide').fadeOut();

                var parent=$(this).parents('.section')
                parent.find('article').slideDown();
                parent.find('.list-hide').fadeIn().css('display','block');
                $(this).fadeOut();
            })
            $(document).on('click','.list-hide',function(){
                var parent=$(this).parent()
                parent.find('article').slideUp();
                $(this).fadeOut();
                parent.find('.list-show').fadeIn();
            })
        })
    </script>  
</body>
</html>